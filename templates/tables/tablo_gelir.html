{% extends "layout.html" %}
{% block title %}Gelir Tablosu{% endblock %}

{% block content %}
<style>
    :root {
        --premium-blue: #4e54c8;
        --premium-gradient: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
        --glass-bg: rgba(255, 255, 255, 0.9);
    }

    .page-header {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border-radius: 24px;
        padding: 2.5rem;
        box-shadow: 0 4px 25px rgba(0,0,0,0.06);
        margin-bottom: 3rem;
    }

    h2.page-title {
        font-weight: 800;
        background: var(--premium-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
    }

    .table-container {
        background: white;
        border-radius: 28px;
        padding: 2.5rem;
        box-shadow: 0 12px 45px rgba(0,0,0,0.07);
        border: 1px solid #f1f5f9;
        margin-bottom: 3rem;
    }

    .gelir-table thead th {
        background: #f8fafc;
        color: #475569;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        padding: 1.3rem 1rem;
        border-bottom: 2px solid #e2e8f0;
    }

    .gelir-table td {
        padding: 1rem;
        border-bottom: 1px solid #f1f5f9;
        font-size: 0.95rem;
    }

    .major-row {
        background: #f8fafc;
        font-weight: 750;
        color: #1e293b;
    }

    .result-row {
        background: #f1f5f9;
        font-weight: 850;
        color: var(--premium-blue);
    }

    .badge-period {
        background: var(--premium-gradient);
        color: white;
        padding: 0.6rem 1.2rem;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 600;
    }

</style>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-xl-9">
            <div class="page-header text-center animate__animated animate__fadeIn">
                <h2 class="page-title">Gelir Tablosu</h2>
                <div class="mt-3">
                    <span class="text-secondary fw-bold fs-5">{{ unvan }}</span>
                </div>
                
                <div class="mt-4">
                    <form method="get" class="d-inline-block">
                        <input type="hidden" name="tur" value="gelir">
                        <input type="hidden" name="vkn" value="{{ vkn }}">
                        <input type="hidden" name="donem" value="{{ donem }}">
                        
                        <div class="input-group">
                            <label class="input-group-text bg-white border-0 text-muted small fw-bold">GÃ–RÃœNÃœM:</label>
                            <select name="donem_turu" class="form-select border-0 bg-light shadow-none fw-semibold" onchange="this.form.submit()" style="border-radius: 10px; width: 240px; height: 45px;">
                                {% if donem_mapping.onceki %}
                                    <option value="onceki" {% if secilen_donem == 'onceki' %}selected{% endif %}>
                                        ðŸ“… Ã–nceki DÃ¶nem ({{ donem_mapping.onceki }})
                                    </option>
                                {% endif %}
                                {% if donem_mapping.cari %}
                                    <option value="cari" {% if secilen_donem == 'cari' %}selected{% endif %}>
                                        ðŸ“… Cari DÃ¶nem ({{ donem_mapping.cari }})
                                    </option>
                                {% endif %}
                            </select>
                        </div>
                    </form>
                </div>
            </div>

            <div class="table-container animate__animated animate__fadeInUp">
                <div class="table-responsive">
                    <table class="table gelir-table align-middle">
                        <thead>
                            <tr>
                                <th style="width: 100px;" class="text-center">KOD</th>
                                <th>HESAP KALEMÄ°</th>
                                <th class="text-end" style="width: 200px;">TUTAR</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in tablo %}
                                {% set kod = row.kod %}
                                {% set aciklama = row.aciklama %}
                                {% set tutar = row.get(gorunen_kolon) %}

                                <tr class="{% if not kod %}result-row{% endif %}">
                                    <td class="text-center text-muted small fw-bold">{{ kod or '' }}</td>
                                    <td class="{% if not kod %}fw-bold{% endif %}">{{ aciklama }}</td>
                                    <td class="text-end {% if not kod %}fw-bold{% endif %}">
                                        {% if tutar is not none %}
                                            {{ tutar | tlformat }}
                                        {% else %}
                                            <span class="text-muted small">-</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="text-center">
                <a href="{{ url_for('data.veri_giris', vkn=vkn, donem=donem) }}" class="btn btn-outline-secondary px-5 py-2.5 shadow-sm" style="border-radius: 14px; font-weight: 600;">
                    <i class="bi bi-arrow-left me-2"></i>Veri YÃ¶netimine DÃ¶n
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
