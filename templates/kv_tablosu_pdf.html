<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <style>
    body {
      font-family: DejaVu Sans, sans-serif;
      font-size: 12pt;
      margin: 25px;
      color: #111;
    }
    .header-container {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #444;
      padding-bottom: 8px;
      margin-bottom: 16px;
    }
    .logo { height: 55px; }
    .header-text { text-align: right; font-size: 10pt; color: #555; }
    .header-title {
      text-align: center;
      font-weight: bold;
      font-size: 14pt;
      margin-bottom: 10px;
      text-transform: uppercase;
      color: #222;
    }
    table { width: 100%; border-collapse: collapse; margin: 0 auto; }
    th, td { padding: 6px 8px; vertical-align: top; }
    .label { width: 55%; font-weight: bold; color: #222; }
    .value { width: 45%; text-align: right; color: #000; }
    tr:nth-child(odd) { background-color: #f8f8f8; }
    .footer { text-align: center; font-size: 10pt; margin-top: 40px; color: #666; }
  </style>
</head>
<body>

  <div class="header-container">
    <div>
      <img src="{{ url_for('static', filename='images/logo1.png', _external=True) }}" alt="Logo" class="logo">
    </div>
    <div class="header-text">
      <div><strong>Tarih:</strong> {{ now().strftime("%d.%m.%Y") }}</div>
      <div><strong>Rapor No:</strong> {{ data.belge_no or '' }}</div>
    </div>
  </div>

  <div class="header-title">Ä°NDÄ°RÄ°MLÄ° KURUMLAR VERGÄ°SÄ° TABLOSU</div>

  {# ğŸ”§ Makrolar #}
  {% macro row(label, value) %}
  <tr>
    <td class="label">{{ label }}</td>
    <td class="value">
      {% if value is not none and value|string|trim != '' %}
        {{ value }}
      {% endif %}
    </td>
  </tr>
  {% endmacro %}

  {% macro currency(value) %}
    {% if value is not none and value|string|trim != '' %}
      {% set fval = value|float %}
      {% if fval == 0 %}
        0,00 â‚º
      {% else %}
        {{ "{:,.2f}".format(fval).replace(",", "X").replace(".", ",").replace("X", ".") }} â‚º
      {% endif %}
    {% endif %}
  {% endmacro %}

  {% macro format_date(val) %}
    {% if val %}
      {% if val.__class__.__name__ == 'datetime' %}
        {{ val.strftime('%d.%m.%Y') }}
      {% else %}
        {{ val }}
      {% endif %}
    {% endif %}
  {% endmacro %}

  <table>
    {{ row("TeÅŸvik Belgesi NumarasÄ±", data.belge_no) }}
    {{ row("TeÅŸvik Belgesinin Hangi Karara GÃ¶re DÃ¼zenlendiÄŸi", data.karar) }}
    {{ row("YatÄ±rÄ±ma BaÅŸlama Tarihi", format_date(data.belge_tarihi)) }}
    {{ row("YatÄ±rÄ±mÄ±n TÃ¼rÃ¼ 1", data.yatirim_turu1) }}
    {{ row("YatÄ±rÄ±mÄ±n TÃ¼rÃ¼ 2", data.yatirim_turu2) }}
    {{ row("Program TÃ¼rÃ¼", data.program_turu) }}
    {{ row("Toplam YatÄ±rÄ±m TutarÄ± (Ä°ndirimli KV KapsamÄ±nda Olmayan Harcamalar HariÃ§)", currency(data.toplam_tutar)) }}
    {{ row("YatÄ±rÄ±ma KatkÄ± OranÄ±", data.katki_orani ~ " %") }}
    {{ row("Vergi Ä°ndirim OranÄ±", data.vergi_orani ~ " %") }}
    {{ row("YatÄ±rÄ±mÄ±n YapÄ±ldÄ±ÄŸÄ± BÃ¶lge", data.bolge) }}
    {{ row("Ä°ndirimli KV OranÄ±", data.diger_oran ~ " %") }}
    {{ row("Toplam YatÄ±rÄ±ma KatkÄ± TutarÄ±", currency(data.katki_tutari)) }}
    {{ row("Cari YÄ±lda Fiilen GerÃ§ekleÅŸtirilen YatÄ±rÄ±m HarcamasÄ± TutarÄ±", currency(data.cari_harcama_tutari)) }}
    {{ row("Fiilen GerÃ§ekleÅŸtirilen YatÄ±rÄ±m HarcamasÄ± (BaÅŸlangÄ±Ã§tan Ä°tibaren)", currency(data.toplam_harcama_tutari)) }}
    {{ row("Fiili YatÄ±rÄ±m HarcamasÄ± Nedeniyle Hak KazanÄ±lan KatkÄ± TutarÄ±", currency(data.fiili_katki_tutari)) }}
    {{ row("EndekslenmiÅŸ Tutarlar Nedeniyle Hak KazanÄ±lan KatkÄ± TutarÄ±", currency(data.endeks_katki_tutari)) }}
    {{ row("Ã–nceki DÃ¶nemlerde YararlanÄ±lan YatÄ±rÄ±ma KatkÄ± (YatÄ±rÄ±mdan Elde Edilen)", currency(data.onceki_yatirim_katki_tutari)) }}
    {{ row("Ã–nceki DÃ¶nemlerde YararlanÄ±lan YatÄ±rÄ±ma KatkÄ± (DiÄŸer Faaliyetlerden)", currency(data.onceki_diger_katki_tutari)) }}
    {{ row("Ã–nceki DÃ¶nemlerde YararlanÄ±lan Toplam KatkÄ± TutarÄ±", currency(data.onceki_katki_tutari)) }}
    {{ row("Cari DÃ¶nemde YararlanÄ±lan YatÄ±rÄ±ma KatkÄ± (YatÄ±rÄ±mdan Elde Edilen)", currency(data.cari_yatirim_katki)) }}
    {{ row("Cari DÃ¶nemde YararlanÄ±lan YatÄ±rÄ±ma KatkÄ± (DiÄŸer Faaliyetlerden)", currency(data.cari_diger_katki)) }}
    {{ row("Cari DÃ¶nemde YararlanÄ±lan Toplam YatÄ±rÄ±ma KatkÄ± TutarÄ±", currency(data.cari_toplam_katki)) }}
    {{ row("Cari DÃ¶nem Dahil Olmak Ãœzere YararlanÄ±lan Toplam KatkÄ± TutarÄ±", currency(data.genel_toplam_katki)) }}
  </table>

  <div class="footer">
    Bu tablo {{ now().strftime("%d.%m.%Y") }} tarihinde otomatik olarak oluÅŸturulmuÅŸtur.<br>
    Â© {{ now().year }} Ä°SFA Yeminli Mali MÃ¼ÅŸavirlik Denetim DanÄ±ÅŸmanlÄ±k
  </div>

</body>
</html>
